{% extends 'configure_server.html' %}
{% block rightSidebarContents %}
<div class="category-name">
Comandos
</div>
<div class="pure-g">
<div class="pure-u-1 pure-u-md-3-4">
<div id="communityTitle" class="toggleSubText">
Precisando ativar/desativar comandos? Então você veio ao lugar certo!
</div>
</div>
<div class="pure-u-1 pure-u-md-1-4">

</div>
</div>
<hr>
<input type="text" id="filterBox" placeholder="Filtrar por nome...">
<script>
$('#filterBox').on('input', function() {
	var text = $(this).val()

	console.log(text)

	filter(text)
});

function getFilterText() {
return $("#filterBox").val()
}

function filter(text) {
	$("#availableCommands").children().each(function() {
		$(this).css('display', '')
	});

	$("#availableCommands").children().each(function() {
	var commandName = $(this).text()

	if (commandName.indexOf(text) == -1) {
		$(this).css('display', 'none')
	}
	});
}

function moveSelectedAllRight() {
	$("#availableCommands").children().each(function() {
		$(this).prop("selected", false)
		$(this).prependTo("#disabledCommands");
	});
	
	filter(getFilterText());
}

function moveSelectedOneRight() {
	$("#availableCommands").children().each(function() {
		if ($(this).is(':selected')) {
			$(this).prop("selected", false)
			$(this).prependTo("#disabledCommands");
		}
	});
	
	filter(getFilterText());
}

function moveSelectedAllLeft() {
	$("#disabledCommands").children().each(function() {
		$(this).prop("selected", false)
		$(this).prependTo("#availableCommands");
	});
	
	filter(getFilterText());
}

function moveSelectedOneLeft() {
	$("#disabledCommands").children().each(function() {
		if ($(this).is(':selected')) {
			$(this).prop("selected", false)
			$(this).prependTo("#availableCommands");
		}
	});
	
	filter(getFilterText());
}

function transformBlockedCommandsToJson() {
var configAttr = {"type":"{{ saveType }}"}
var disabledCommands = []

$("#disabledCommands").children().each(function() {
	var value = $(this).val();
	disabledCommands.push(value)
});

configAttr["disabledCommands"] = disabledCommands

console.log(configAttr);

var json = JSON.stringify(configAttr);

sendJsonToServer(json);
}
</script>
<div class="pure-g">
<div class="pure-u-1 pure-u-md-1-2">
<div class="flavourText">Comandos ativados</div>
<div style="margin: 5px">
<select id="availableCommands" multiple style="width: 100%; height: 35vh;">
  {% for command in enabledCommands %}
  <option value="{{ command.getClass.getSimpleName }}">{{ serverConfig.commandPrefix }}{{ command.getLabel }}</option>
  {% endfor %}
</select> 
</div>
</div>
<div class="pure-u-1 pure-u-md-1-2">
<div style="margin: 5px">
<div class="flavourText">Comandos desativados</div>
<select id="disabledCommands" multiple style="width: 100%; height: 35vh;">
  {% for command in disabledCommands %}
  <option value="{{ command.getClass.getSimpleName }}">{{ serverConfig.commandPrefix }}{{ command.getLabel }}</option>
  {% endfor %}
</select>
</div>
</div>
</div>
<div style="text-align: center;">
<button onclick="moveSelectedAllRight()" class="button-discord button-discord-info pure-button"><i class="fas fa-angle-double-right"></i></button>
<button onclick="moveSelectedOneRight()" class="button-discord button-discord-info pure-button"><i class="fas fa-angle-right"></i></button>
<button onclick="moveSelectedOneLeft()" class="button-discord button-discord-info pure-button"><i class="fas fa-angle-left"></i></button>
<button onclick="moveSelectedAllLeft()" class="button-discord button-discord-info pure-button"><i class="fas fa-angle-double-left"></i></button>
</div>
{#
<div id="left-sidebar-contents" style="width: 25.5%; float: left;">
	<div class="server-name">
	Comandos
	</div>
	{% for command in commands %}
	<div data-clickable-role="true" onclick="displayRoleStuff(this, '{{ command.getClass.getSimpleName }}');" class="item" style="font-weight: 600; overflow: hidden;text-overflow: ellipsis;white-space: nowrap;">
	{{ serverConfig.commandPrefix }}{{ command.getLabel }}
	</div>
	{% endfor %}
</div>
<div style="padding: 0px 0px 80px 20px;">
{% for command in commands %}
<div id="role-{{ command.getClass.getSimpleName }}" data-internal-id="{{ command.getClass.getSimpleName }}" style="width: 74.5%; float: right;" class="totallyHidden">
teste
<hr>
<br style="clear: both" /> <!-- So dirty! -->
</div>
{% endfor %}
</div>
#}
<hr>
<button onclick="transformBlockedCommandsToJson()" style="float: right;" class="button-discord button-discord-success pure-button">{{ DASHBOARD_SAVE }}</button>
<br style="clear: both" /> <!-- So dirty! -->
{% endblock %}